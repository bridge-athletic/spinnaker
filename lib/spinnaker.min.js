!function(){var a;a=function(){function a(){this.defaultActions={get:{method:"get"},create:{method:"post"},save:{method:function(a){return null!=(null!=a?a.id:void 0)?"put":"post"}},update:{method:"put"},destroy:{method:"delete"},query:{method:"get",isArray:!0}}}return a.prototype.setUrl=function(a){this.url=a},a.prototype.setMock=function(a){this.mock=a},a.prototype.setDefaultActions=function(a){this.defaultActions=a},a.prototype.$get=function(a){var b;return b=["$window","$rootScope","$q"],this.mock&&b.push("spinnakerMock"),b.push(this.service.bind(this)),a.invoke(b)},a.prototype.service=function(a,b,c,d){var e,f,g,h,i,j=this;return e=null!=(g=null!=(h=this.url)?h:null!=(i=a.location)?i.origin:void 0)?g:"http://localhost:1337",f=null!=d?d:a.io.connect(e),function(a,d,e){var g,h,i,k,l,m,n,o,p,q;null==d&&(d="/"+a+"/:id"),e=angular.extend({},j.defaultActions,e),m=function(a,b){var c,d;for(c in b)d=b[c],null!=d&&(a=a.replace(":"+c,d));return a=a.replace(/\/?:\w+/g,""),a.replace(/\/$/,"")},n=function(a,d,e){var g;return null==d&&(d={}),null==e&&(e="get"),g=c.defer(),f[e](a,d,function(a){return b.$apply(function(){return g.resolve(a)})}),g.promise},k=function(a){return function(b,e,f,i){var j,k,l,o,p,q,r,s,t,u,v,w,x;return u=function(){switch(arguments.length){case 4:return[b,e,f,i];case 3:case 2:return angular.isFunction(e)?angular.isFunction(b)?[null,null,b,e]:[b,null,e,f]:[b,e,f,i];case 1:return angular.isFunction(b)?[null,null,b,null]:[b,null,null,null];default:return[null,null,null,null]}}.apply(this,arguments),p=u[0],j=u[1],s=u[2],k=u[3],l=this instanceof g,null==p&&(p=l?this:{}),o=null!=(v=a.method)?v:"get",angular.isFunction(a.method)&&(o=a.method(p)),/^(POST|PUT|PATCH|DELETE)$/i.test(o)&&null==j&&(j=p),r=null!=(w=a.resource)?w:g,t=a.isArray?new h(r,a.filter):l?this:new r(j),q=n(m(null!=(x=a.url)?x:d,p),j,o).then(function(b){var c,d,e;if(q=t.$promise,null!=b)if(a.isArray)for(t.length=0,d=0,e=b.length;e>d;d++)c=b[d],t.push(new r(c).subscribe());else angular.copy(b,t),t.$promise=q;return t.$resolved=!0,t.subscribe(),null!=s?s(b):void 0},function(a){return t.$resolved=!0,null!=k&&k(a),c.reject(a)}),l?q:(t.$promise=q,t.$resolved=!1,t)}},o=function(){return this.unsubscribe(),this._subscription=this._msgHandler.bind(this),f.on("message",this._subscription),this},p=function(){return null!=this._subscription&&f.removeListener("message",this._subscription),this._subscription=null,this},h=function(a,c){var d;return null==c&&(c=function(){return!0}),d=new Array,d.subscribe=o.bind(d),d.unsubscribe=p.bind(d),d._msgHandler=function(e){return e.model!==a.model?!1:"create"!==e.verb||c(e.data)?b.$apply(function(){var b,f,g,h,i,j,k,l;switch(e.verb){case"create":if(c(e.data))return d.push(new a(e.data).subscribe());break;case"destroy":for(g=[],b=h=0,j=d.length;j>h;b=++h)f=d[b],null!=(null!=f?f.id:void 0)&&f.id===e.id&&(g.push(b),f.unsubscribe());for(l=[],i=0,k=g.length;k>i;i++)b=g[i],l.push(d.splice(b,1));return l}}):!1},d},g=function(){function c(a){null!=a&&angular.copy(a,this)}var d,f;c.model=a;for(f in e)d=e[f],c[f]=k(d);return c.prototype.subscribe=o,c.prototype.unsubscribe=p,c.prototype._msgHandler=function(a){var c=this;return a.model===this.constructor.model&&a.id===this.id&&"update"===a.verb?b.$apply(function(){return null!=a.data?angular.copy(a.data,c):void 0}):void 0},c}(),q=function(a){return g.prototype[a]=function(){var b,c;return b=g[a].bind(this).apply(null,arguments),null!=(c=b.$promise)?c:b}};for(l in e)i=e[l],q(l,i);return g}},a}(),angular.module("spinnaker",[]).provider("spinnaker",a)}.call(this);